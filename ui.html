<link
  rel="stylesheet"
  href="https://static.figma.com/api/figma-extension-api-0.0.1.css"
/>

<div id="panel">
  <h2>Count Text Nodes</h2>
  <div>
    <label for="find">Find</label>
    <input type="input" id="find" placeholder="Find" value="" />
  </div>
  <div>
    <label for="replace">Replace</label>
    <input type="input" id="replace" placeholder="Replace" />
  </div>
  <button id="find">Count</button>
  <div>
    <p>Found nodes:</p>
    <p style="font-size: 20px" id="count">0</p>
  </div>
</div>

<script>
  let keyupTimeout;
  document.getElementById("panel").addEventListener("keyup", (e) => {
    if (e.target.id === 'find') {
      clearTimeout(keyupTimeout)
      keyupTimeout = setTimeout(function () {
        parent.postMessage({ pluginMessage: {
          type: "find-text",
          value: e.target.value }
        }, "*");
      }, 700)
    }
  });
  document.getElementById("find").onclick = () => {
    parent.postMessage({ pluginMessage: { type: "find-button" } }, "*");
  };
  onmessage = (event) => {
    document.getElementById("count").textContent = event.data.pluginMessage;
  };
</script>
